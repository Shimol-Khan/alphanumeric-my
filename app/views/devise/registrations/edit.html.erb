<% content_for :title do %>
  Account Update
<% end %>

<!-------------------- Main Navbar ------------------>
<% if user_signed_in? %>
    <% if current_user.admin? %>
        <%= render 'shared/nav_admin' %>
    <% else %>
        <%= render 'shared/nav_user' %>
    <% end %>
<% else %>
    <%= render 'shared/nav_public' %>
<% end %>
<!-------------------/ Main Navbar ------------------>

<!-------------------- Edit Registration Form ----------------->
<div class="mx-4 min-h-screen md:pt-5 pb-6 px-2 md:px-0" style="font-family:'Lato',sans-serif;">
  <main class="bg-white max-w-7xl mx-auto p-8 md:p-12 my-10 md:my-4 rounded-lg shadow-2xl">
    <section>
      <div>
        <%= link_to root_path, :class=>"text-sm text-gray-400 hover:text-gray-600" do %>
          <i class="fas fa-angle-left"></i>
          Back
        <% end %>
      </div>
      <h3 class="font-bold text-2xl">Update Your Account</h3>
      <div class="flex justify-center">
        <% if current_user.image_link? %>
        <%= image_tag(current_user.image_link, :class=>"h-28 w-28 shadow-lg rounded-full")%>
      <% else %>
        <img src="https://miro.medium.com/max/720/1*W35QUSvGpcLuxPo3SRTH4w.png" class="h-28 w-28 shadow-lg rounded-full">
      <% end %>
      </div>
      <p class="text-center py-3 text-gray-500 font-xl"><%= current_user.name %></p>
    </section>

    <section class="mt-10">
    <%= simple_form_for(resource, as: resource_name,:class=>"flex flex-col", url: registration_path(resource_name), html: { method: :put }) do |f| %>
      <small class="py-2 text-gray-400">BASIC INFORMATION</small>
        <div class="mb-6 pt-3 rounded bg-gray-200">
          <label class="block text-gray-700 text-sm font-bold mb-2 ml-3" for="name">Name</label>
          <%= f.input :name,
                label: false,
                required: false,
                error: false,
                autofocus: true,
                input_html: { autocomplete: "name",:class=>"bg-gray-200 rounded w-full text-gray-700 focus:outline-none border-b-4 border-gray-300 focus:border-purple-600 transition duration-500 px-3 pb-3" }
          %>
        </div>
        <div class="mb-6 pt-3 rounded bg-gray-200">
          <label class="block text-gray-700 text-sm font-bold mb-2 ml-3" for="name">Email</label>
          <%= f.input :email,
                label: false,
                error: false,
                required: false,
                autofocus: false,
                input_html: { autocomplete: "email",:class=>"bg-gray-200 rounded w-full text-gray-700 focus:outline-none border-b-4 border-gray-300 focus:border-purple-600 transition duration-500 px-3 pb-3" }
          %>
        </div>

        <% if devise_mapping.confirmable? && resource.pending_reconfirmation? %>
          <p>Currently waiting confirmation for: <%= resource.unconfirmed_email %></p>
        <% end %>

        <div class="mb-6 pt-3 rounded bg-gray-200">
          <label class="block text-gray-700 text-sm font-bold mb-2 ml-3" for="name">Contact Number</label>
          <%= f.input :contact_number,
                label: false,
                required: false,
                error: false,
                autofocus: false,
                input_html: { autocomplete: "contact-number",:class=>"bg-gray-200 rounded w-full text-gray-700 focus:outline-none border-b-4 border-gray-300 focus:border-purple-600 transition duration-500 px-3 pb-3" }
          %>
        </div>
        <div class="mb-6 pt-3 rounded bg-gray-200">
          <label class="block text-gray-700 text-sm font-bold mb-2 ml-3" for="name">Image URL</label>
          <%= f.input :image_link,
                label: false,
                required: false,
                error: false,
                autofocus: false,
                input_html: { autocomplete: "image-link",:class=>"bg-gray-200 rounded w-full text-gray-700 focus:outline-none border-b-4 border-gray-300 focus:border-purple-600 transition duration-500 px-3 pb-3" }
          %>
        </div>
        <div class="mb-6 pt-3 rounded bg-gray-200">
          <label class="block text-gray-700 text-sm font-bold mb-2 ml-3" for="name">Facebook URL</label>
          <%= f.input :fb_link,
                label: false,
                required: false,
                error: false,
                autofocus: false,
                input_html: { autocomplete: "fb-link",:class=>"bg-gray-200 rounded w-full text-gray-700 focus:outline-none border-b-4 border-gray-300 focus:border-purple-600 transition duration-500 px-3 pb-3" }
          %>
        </div>
        <div class="mb-6 pt-3 rounded bg-gray-200">
          <label class="block text-gray-700 text-sm font-bold mb-2 ml-3" for="name">Instagram URL</label>
          <%= f.input :ig_link,
                label: false,
                required: false,
                error: false,
                autofocus: false,
                input_html: { autocomplete: "ig-link",:class=>"bg-gray-200 rounded w-full text-gray-700 focus:outline-none border-b-4 border-gray-300 focus:border-purple-600 transition duration-500 px-3 pb-3" }
          %>
        </div>
        <div class="mb-6 pt-3 rounded bg-gray-200">
          <label class="block text-gray-700 text-sm font-bold mb-2 ml-3" for="name">Twitter URL</label>
          <%= f.input :twitter_link,
                label: false,
                required: false,
                error: false,
                autofocus: false,
                input_html: { autocomplete: "twitter-link",:class=>"bg-gray-200 rounded w-full text-gray-700 focus:outline-none border-b-4 border-gray-300 focus:border-purple-600 transition duration-500 px-3 pb-3" }
          %>
        </div>
        <div class="mb-6 pt-3 rounded bg-gray-200">
          <label class="block text-gray-700 text-sm font-bold mb-2 ml-3" for="name">LinkedIn URL</label>
          <%= f.input :in_link,
                label: false,
                required: false,
                error: false,
                autofocus: false,
                input_html: { autocomplete: "in-link",:class=>"bg-gray-200 rounded w-full text-gray-700 focus:outline-none border-b-4 border-gray-300 focus:border-purple-600 transition duration-500 px-3 pb-3" }
          %>
        </div>
        <div class="mb-6 pt-3 rounded bg-gray-200">
          <label class="block text-gray-700 text-sm font-bold mb-2 ml-3" for="name">About</label>
          <%= f.input :about,
                label: false,
                required: false,
                error: false,
                autofocus: false,
                input_html: {:class=>"bg-gray-200 rounded w-full text-gray-700 focus:outline-none border-b-4 border-gray-300 focus:border-purple-600 transition duration-500 px-3 pb-3" }
          %>
        </div>
        <div class="mb-6 pt-3 rounded bg-gray-200">
          <label class="block text-gray-700 text-sm font-bold mb-2 ml-3" for="name">Password</label>
          <%= f.input :password,
                label: false,
                error: false,
                required: true,
                input_html: { autocomplete: "new-password",:class=>"bg-gray-200 rounded w-full text-gray-700 focus:outline-none border-b-4 border-gray-300 focus:border-purple-600 transition duration-500 px-3 pb-3" }
          %>
        </div>
        <div class="mb-6 pt-3 rounded bg-gray-200">
          <label class="block text-gray-700 text-sm font-bold mb-2 ml-3" for="name">Retype Password</label>
          <%= f.input :password_confirmation,
                label: false,
                error: false,
                required: true,
                input_html: { autocomplete: "new-password",:class=>"bg-gray-200 rounded w-full text-gray-700 focus:outline-none border-b-4 border-gray-300 focus:border-purple-600 transition duration-500 px-3 pb-3" }
          %>
        </div>
        <div class="mb-1 pt-3 rounded bg-gray-200">
          <label class="block text-gray-700 text-sm font-bold mb-2 ml-3" for="name">Current Password</label>
          <%= f.input :current_password,
                label: false,
                error: false,
                required: true,
                input_html: { autocomplete: "current-password",:class=>"bg-gray-200 rounded w-full text-gray-700 focus:outline-none border-b-4 border-gray-300 focus:border-purple-600 transition duration-500 px-3 pb-3" }
          %>
        </div>
        <small class="block text-gray-400 mb-2">We need your current password to confirm your changes</small>

        <%= f.button :submit, "Update Account",:class=>"w-full bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded shadow-lg hover:shadow-xl transition duration-200" %>
      <% end %>
    </section>
  </main>

  <div class="max-w-lg mx-auto text-center mt-12 mb-6">
    <p class="text-gray-500">Want to delete your Account?
      <%= link_to "Delete Account", "#",:class=>"modal-open font-bold hover:underline"%>
    </p>
  </div>
</div>
<!-------------------/ Edit Registration Form ----------------->

<!--------------------- Account Delete Moda ------------------->
<div class="modal opacity-0 pointer-events-none fixed w-full h-full top-0 left-0 flex items-center justify-center">
  <div class="modal-overlay absolute w-full h-full bg-gray-900 opacity-50"></div>
    <div class="modal-container bg-white w-11/12 md:max-w-md mx-auto rounded shadow-lg z-50 overflow-y-auto">
      <div class="modal-close absolute top-0 right-0 cursor-pointer flex flex-col items-center mt-4 mr-4 text-white text-sm z-50">
        <svg class="fill-current text-white" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18">
          <path d="M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z"></path>
        </svg>
        <span class="text-sm">(Esc)</span>
      </div>
      <div class="modal-content py-4 text-left px-6">
        <div class="flex justify-between items-center pb-3">
          <p class="text-2xl font-bold"><i class="fas fa-exclamation-triangle mr-2"></i> Attention</p>
          <div class="modal-close cursor-pointer z-50">
            <svg class="fill-current text-black" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18">
              <path d="M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z"></path>
            </svg>
          </div>
        </div>
        <p>Your Account can not be recovered once you deleted it. If you accidentally clicked here, click the <span class="text-green-400">close</span> button. If you really want to <span class="text-red-400">delete</span> your account then press the Delete button.</p>
        <div class="flex justify-end pt-2">
          <%= link_to "Delete Account", registration_path(resource_name),:class=>"px-4 bg-red-400 p-3 rounded-lg text-gray-100 hover:bg-red-500 hover:text-gray-100 mr-2", method: :delete %>
          <button class="modal-close px-4 bg-indigo-500 p-3 rounded-lg text-white hover:bg-indigo-400">Close</button>
        </div>
    </div>
  </div>
</div>
<!--------------------/ Account Delete Moda ------------------->

<!-------------------- Required JS For Modal ------------------>
<script>
  var openmodal = document.querySelectorAll('.modal-open')
    for (var i = 0; i < openmodal.length; i++) {
      openmodal[i].addEventListener('click', function(event){
    	event.preventDefault()
    	toggleModal()
      })
    }
    
    const overlay = document.querySelector('.modal-overlay')
    overlay.addEventListener('click', toggleModal)
    
    var closemodal = document.querySelectorAll('.modal-close')
    for (var i = 0; i < closemodal.length; i++) {
      closemodal[i].addEventListener('click', toggleModal)
    }
    
    document.onkeydown = function(evt) {
      evt = evt || window.event
      var isEscape = false
      if ("key" in evt) {
    	isEscape = (evt.key === "Escape" || evt.key === "Esc")
      } else {
    	isEscape = (evt.keyCode === 27)
      }
      if (isEscape && document.body.classList.contains('modal-active')) {
    	toggleModal()
      }
    };
    
    function toggleModal () {
      const body = document.querySelector('body')
      const modal = document.querySelector('.modal')
      modal.classList.toggle('opacity-0')
      modal.classList.toggle('pointer-events-none')
      body.classList.toggle('modal-active')
    }
</script>
<!-------------------/ Required JS For Modal ------------------>